<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/app.html}"
>
  <head>
    <meta charset="UTF-8" />
    <title>Accesos Inactivos</title>
  </head>

  <body>
    <section layout:fragment="content">
      <!-- Mensajes-->
      <div
        th:if="${success}"
        class="alert alert-success mb-3"
        th:text="${success}"
      ></div>

      <div class="card-custom">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h3 class="page-title mb-0">Accesos Inactivos</h3>
          <div class="d-flex gap-2">
            <a th:href="@{/ingresos/accesos}" class="btn-primary-custom">
              <i class="bi bi-box-arrow-left"></i> Volver
            </a>
          </div>
        </div>

        <!-- Buscador -->
        <div class="card-custom mb-3">
          <div class="d-flex justify-content-between align-items-center">
            <span class="badge bg-success">
              Total Inactivos: <span th:text="${accesos.size()}"></span>
            </span>

            <form
              th:action="@{/ingresos/accesos/inactivos}"
              method="get"
              class="d-flex gap-2"
            >
              <input
                type="text"
                name="busqueda"
                class="form-control form-control-sm"
                placeholder="Buscar acceso..."
                th:value="${busqueda}"
              />
              <button class="btn-primary-custom">
                <i class="bi bi-search"></i>
              </button>
              <a
                th:href="@{/ingresos/accesos/inactivos}"
                class="btn-secondary-custom"
              >
                <i class="bi bi-arrow-clockwise"></i>
              </a>
            </form>
          </div>
        </div>

        <!-- TABLA -->
        <div class="table-responsive">
          <table class="table table-modern">
            <thead>
              <tr>
                <th>ID</th>
                <th>Persona</th>
                <th>Motivo</th>
                <th>Fecha</th>
                <th>Empresa</th>
                <th>Acciones</th>
              </tr>
            </thead>

            <tbody>
              <tr th:each="acceso : ${accesos}">
                <td th:text="${acceso.id}"></td>

                <td
                  th:text="${acceso.persona != null ? acceso.persona.nombreUno : 'Null'}"
                ></td>

                <td th:text="${acceso.motivo}"></td>

                <td
                  th:text="${#temporals.format(acceso.Fecha_ingreso, 'yyyy-MM-dd HH:mm')}"
                ></td>

                <td
                  th:text="${acceso.empresa != null ? acceso.empresa.nombre : 'Null'}"
                ></td>

                <td>
                  <div class="d-flex gap-2">
                    <form
                      th:action="@{'/ingresos/accesos/' + ${acceso.id} + '/activar'}"
                      method="post"
                      sec:authorize="hasRole('Administrador')"
                      onsubmit="return confirm('Â¿Activar este acceso?')"
                      style="display: inline"
                    >
                      <button class="btn-activate table-btn" type="submit">
                        <i class="bi bi-check-circle"></i>
                      </button>
                    </form>
                  </div>
                </td>
              </tr>

              <tr th:if="${#lists.isEmpty(accesos)}">
                <td colspan="6" class="text-center">
                  No hay accesos inactivos.
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>
  </body>
</html>
